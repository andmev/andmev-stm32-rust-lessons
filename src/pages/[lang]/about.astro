---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { getAvailableLanguages } from '@/utils/languages';
import { getEntry, render } from 'astro:content';

export async function getStaticPaths() {
  const languages = await getAvailableLanguages();
  return languages.map((lang) => ({ params: { lang } }));
}

const { lang } = Astro.params;

// Load about page content from MDX
const aboutContent = await getEntry('pages', `${lang}/about`);
if (!aboutContent) {
  throw new Error(`About page content not found for language: ${lang}`);
}

const { Content } = await render(aboutContent);
const pageDescription =
  aboutContent.data.description ?? 'Learn what STM32 Rust Lessons offers and how it can help you.';
---

<BaseLayout
  lang={lang}
  title={aboutContent.data.title}
  description={pageDescription}
  ogTitle={aboutContent.data.ogTitle || aboutContent.data.title}
  ogDescription={aboutContent.data.ogDescription || pageDescription}
  ogImage={aboutContent.data.ogImage}
  ogType={aboutContent.data.ogType || 'article'}
  twitterCard={aboutContent.data.twitterCard || 'summary'}
  canonicalUrl={aboutContent.data.canonicalUrl}
>
  <article class="mx-auto w-full max-w-[78rem] px-4 pt-16 pb-20 sm:px-6 md:pt-24 md:pb-28">
    <div class="mx-auto w-full max-w-[min(82vw,68rem)]">
      <div class="lesson-prose">
        <Content />
      </div>
    </div>
  </article>
</BaseLayout>
